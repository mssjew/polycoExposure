<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polyco-EcoFibre Exposure Payoff Plan</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
        }

        .header-section {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 3px solid #e9ecef;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 32px;
            font-weight: 600;
        }

        .subtitle {
            color: #6c757d;
            font-size: 18px;
            margin-bottom: 20px;
        }

        .date-stamp {
            color: #95a5a6;
            font-size: 14px;
            font-style: italic;
        }

        .exposure-breakdown {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #a8b5c8;
        }

        .exposure-breakdown h2 {
            font-size: 20px;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .breakdown-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .breakdown-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #dee2e6;
        }

        .breakdown-label {
            font-size: 13px;
            color: #6c757d;
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .breakdown-value {
            font-size: 28px;
            font-weight: bold;
            color: #2c3e50;
        }

        .breakdown-total {
            background: #a8b5c8;
            border: none;
        }

        .breakdown-total .breakdown-label {
            color: #2c3e50;
            opacity: 1;
        }

        .breakdown-total .breakdown-value {
            color: #2c3e50;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-left: 5px solid;
        }

        .card.pastel-blue {
            background: #e3f2fd;
            border-left-color: #90caf9;
        }

        .card.pastel-pink {
            background: #fce4ec;
            border-left-color: #f48fb1;
        }

        .card.pastel-green {
            background: #e8f5e9;
            border-left-color: #81c784;
        }

        .card.pastel-yellow {
            background: #fff9c4;
            border-left-color: #fff176;
        }

        .card-title {
            font-size: 13px;
            color: #6c757d;
            margin-bottom: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .card-value {
            font-size: 32px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .card-subvalue {
            font-size: 15px;
            color: #6c757d;
        }

        .commitment-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .commitment-box h3 {
            color: #155724;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .commitment-box ul {
            margin-left: 20px;
            line-height: 2;
        }

        .commitment-box li {
            color: #155724;
            font-size: 16px;
            margin-bottom: 8px;
        }

        .commitment-box strong {
            font-weight: 700;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            background: white;
        }

        thead {
            background: #a8b5c8;
            color: white;
        }

        th {
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            white-space: nowrap;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 14px 10px;
            border-bottom: 1px solid #e9ecef;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        .positive {
            color: #28a745;
            font-weight: 600;
        }

        .negative {
            color: #dc3545;
            font-weight: 600;
        }

        .neutral {
            color: #6c757d;
        }

        .machines {
            color: #5a67d8;
            font-weight: 600;
        }

        .arrow-up {
            color: #dc3545;
            font-size: 12px;
            margin-left: 5px;
        }

        .arrow-down {
            color: #28a745;
            font-size: 12px;
            margin-left: 5px;
        }

        .phase-oct-dec {
            background: #fff3cd;
        }

        .phase-jan-feb {
            background: #cfe2ff;
        }

        .phase-mar-plus {
            background: #d1e7dd;
        }

        .phase-payoff {
            background: #d4edda;
            font-weight: bold;
        }

        .highlight {
            background: #fff9c4;
            font-weight: bold;
        }

        .performance-indicators {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #81c784;
        }

        .performance-indicators h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 20px;
        }

        .performance-indicators ul {
            margin-left: 20px;
            line-height: 2;
        }

        .performance-indicators li {
            color: #2c3e50;
            font-size: 15px;
            margin-bottom: 10px;
        }

        .notes {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-top: 30px;
            border-left: 5px solid #a8b5c8;
        }

        .notes h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .notes ul {
            margin-left: 20px;
            line-height: 1.9;
        }

        .notes li {
            color: #495057;
            margin-bottom: 8px;
        }

        .alert-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
        }

        .alert-box strong {
            color: #856404;
        }

        .info-box {
            background: #cfe2ff;
            border-left: 5px solid #0d6efd;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
        }

        .info-box strong {
            color: #084298;
        }

        .info-box p {
            color: #084298;
            margin: 0;
            line-height: 1.6;
        }

        @media print {
            body {
                background: white;
            }
            .container {
                box-shadow: none;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            table {
                font-size: 11px;
            }

            th, td {
                padding: 10px 6px;
            }

            .card-value {
                font-size: 24px;
            }

            .breakdown-value {
                font-size: 22px;
            }

            h1 {
                font-size: 24px;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2"></script>
</head>
<body>
    <div class="container">
        <div class="header-section">
            <h1>ü§ù Polyco-EcoFibre Partnership</h1>
            <div class="subtitle">Exposure Management & Payoff Plan</div>
            <div class="date-stamp">Prepared: October 2025</div>
            <div style="margin-top: 20px;">
                <a href="polyco-historical-order-details.html" style="display: inline-block; padding: 10px 24px; background: #2c3e50; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; transition: background 0.3s ease; margin-right: 10px;">
                    View Historical Order Details ‚Üí
                </a>
                <a href="orders-shipped.html" style="display: inline-block; padding: 10px 24px; background: #28a745; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; transition: background 0.3s ease;">
                    View Shipped Orders ‚Üí
                </a>
            </div>
        </div>

        <div class="commitment-box">
            <h3>‚úÖ EcoFibre's Strategic Commitments</h3>
            <ul>
                <li><strong>Q4 2025 (Oct-Dec):</strong> Continue business as normal, deliver pending POs, scale to 8 machines by Jan 2026</li>
                <li><strong>January-February 2026:</strong> Begin monthly payments at $25,000/month with 8 machines</li>
                <li><strong>March-June 2026:</strong> Increase payments to $50,000/month, scale to 11 machines</li>
                <li><strong>July 2026 onwards:</strong> Accelerate payments to $80,000/month with 13 machines until fully paid</li>
            </ul>
        </div>
        
        <div class="exposure-breakdown">
            <h2>üìä Current Exposure Breakdown</h2>
            <div class="breakdown-grid">
                <div class="breakdown-item breakdown-total">
                    <div class="breakdown-label">Total Current Exposure</div>
                    <div class="breakdown-value">$1,158,807</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-label">Pending POs to Deliver</div>
                    <div class="breakdown-value">$619,706</div>
                    <div class="breakdown-label" style="margin-top: 8px; font-size: 11px; text-transform: none;">15 POs in production/to be delivered</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-label">Pure Advance</div>
                    <div class="breakdown-value">$539,101</div>
                    <div class="breakdown-label" style="margin-top: 8px; font-size: 11px; text-transform: none;">Requires structured payback</div>
                </div>
            </div>
        </div>

        <div class="info-box">
            <strong>Why Continue Normal Payments in Q4 2025?</strong>
            <p style="margin-top: 10px;">Of the $1,158,807 exposure, <strong>$619,706 (53%)</strong> represents active PO fulfillment - normal working capital. Continuing regular payments allows EcoFibre to deliver these orders efficiently while preparing for systematic payback starting January 2026. Reducing payments now would disrupt production and delay the overall payoff timeline.</p>
        </div>

        <div class="summary-cards">
            <div class="card pastel-blue">
                <div class="card-title">Starting Exposure</div>
                <div class="card-value">$1,158,807</div>
                <div class="card-subvalue">October 2025</div>
            </div>
            <div class="card pastel-pink">
                <div class="card-title">Peak Exposure</div>
                <div class="card-value">$1,192,713</div>
                <div class="card-subvalue">December 2025 (+$33,906)</div>
            </div>
            <div class="card pastel-green">
                <div class="card-title">Complete Payoff Date</div>
                <div class="card-value">June 2027</div>
                <div class="card-subvalue">20 months from today</div>
            </div>
            <div class="card pastel-yellow">
                <div class="card-title">Total Payments Made</div>
                <div class="card-value">$1,192,713</div>
                <div class="card-subvalue">Over 18 payment months</div>
            </div>
        </div>

        <div class="performance-indicators">
            <h3>üìà Performance Indicators Demonstrating Control</h3>
            <ul>
                <li>‚úÖ <strong>Limited Exposure Growth:</strong> Only +$33,906 (2.9%) increase during Q4 2025 - minimal and controlled</li>
                <li>‚úÖ <strong>Peak Exposure Defined:</strong> Maximum of $1,192,713 in December 2025, then consistent decline</li>
                <li>‚úÖ <strong>Production Capacity Scaling:</strong> 5 ‚Üí 6 ‚Üí 8 ‚Üí 11 ‚Üí 13 machines = 160% capacity increase by July 2026</li>
                <li>‚úÖ <strong>Positive Cash Flow Maintained:</strong> EcoFibre retains working capital every single month during payback</li>
            </ul>
        </div>

        <div class="alert-box">
            <strong>‚ö†Ô∏è Risk of Reducing Payments in Q4 2025:</strong> Cutting payments now would disrupt EcoFibre's ability to deliver the $619,706 in pending POs, delay machine scale-up, and potentially extend the overall payoff timeline beyond March 2027. Maintaining current terms ensures smooth transition to systematic payback.
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Machines</th>
                        <th>Value Delivered</th>
                        <th>Polyco Pays EcoFibre</th>
                        <th>Net Impact</th>
                        <th>Exposure Payment</th>
                        <th>Exposure Balance</th>
                        <th>Cash Retained</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="phase-oct-dec highlight">
                        <td><strong>Oct 2025</strong></td>
                        <td class="machines">5 machines</td>
                        <td class="positive">+$224,880</td>
                        <td class="negative">-$213,426</td>
                        <td class="positive">+$11,454</td>
                        <td class="neutral">$0</td>
                        <td class="negative">$1,170,261 <span class="arrow-up">‚ñ≤</span></td>
                        <td class="neutral">$0</td>
                        <td>Continue business as normal - controlled exposure increase</td>
                    </tr>
                    <tr class="phase-oct-dec">
                        <td><strong>Nov 2025</strong></td>
                        <td class="machines">6 machines</td>
                        <td class="positive">+$221,560</td>
                        <td class="negative">-$210,334</td>
                        <td class="positive">+$11,226</td>
                        <td class="neutral">$0</td>
                        <td class="negative">$1,181,487 <span class="arrow-up">‚ñ≤</span></td>
                        <td class="neutral">$0</td>
                        <td>Continue business as normal - delivering pending POs</td>
                    </tr>
                    <tr class="phase-oct-dec">
                        <td><strong>Dec 2025</strong></td>
                        <td class="machines">6 machines</td>
                        <td class="positive">+$221,560</td>
                        <td class="negative">-$210,334</td>
                        <td class="positive">+$11,226</td>
                        <td class="neutral">$0</td>
                        <td class="negative">$1,192,713 <span class="arrow-up">‚ñ≤</span></td>
                        <td class="neutral">$0</td>
                        <td>Continue business as normal - ‚ö†Ô∏è PEAK EXPOSURE REACHED</td>
                    </tr>
                    <tr class="phase-jan-feb">
                        <td><strong>Jan 2026</strong></td>
                        <td class="machines">8 machines</td>
                        <td class="positive">+$294,240</td>
                        <td class="negative">-$253,532</td>
                        <td class="positive">+$40,708</td>
                        <td class="negative">-$25,000</td>
                        <td class="negative">$1,167,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$15,708</td>
                        <td>Pay $25,000 to Polyco - 8 machines operational</td>
                    </tr>
                    <tr class="phase-jan-feb">
                        <td><strong>Feb 2026</strong></td>
                        <td class="machines">8 machines</td>
                        <td class="positive">+$294,240</td>
                        <td class="negative">-$253,532</td>
                        <td class="positive">+$40,708</td>
                        <td class="negative">-$25,000</td>
                        <td class="negative">$1,142,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$15,708</td>
                        <td>Pay $25,000 to Polyco - 8 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Mar 2026</strong></td>
                        <td class="machines">11 machines</td>
                        <td class="positive">+$403,140</td>
                        <td class="negative">-$337,225</td>
                        <td class="positive">+$65,915</td>
                        <td class="negative">-$50,000</td>
                        <td class="negative">$1,092,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$15,915</td>
                        <td>Pay $50,000 to Polyco - 11 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Apr 2026</strong></td>
                        <td class="machines">11 machines</td>
                        <td class="positive">+$403,140</td>
                        <td class="negative">-$337,225</td>
                        <td class="positive">+$65,915</td>
                        <td class="negative">-$50,000</td>
                        <td class="negative">$1,042,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$15,915</td>
                        <td>Pay $50,000 to Polyco - 11 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>May 2026</strong></td>
                        <td class="machines">11 machines</td>
                        <td class="positive">+$403,140</td>
                        <td class="negative">-$337,225</td>
                        <td class="positive">+$65,915</td>
                        <td class="negative">-$50,000</td>
                        <td class="negative">$992,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$15,915</td>
                        <td>Pay $50,000 to Polyco - 11 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Jun 2026</strong></td>
                        <td class="machines">11 machines</td>
                        <td class="positive">+$403,140</td>
                        <td class="negative">-$337,225</td>
                        <td class="positive">+$65,915</td>
                        <td class="negative">-$50,000</td>
                        <td class="negative">$942,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$15,915</td>
                        <td>Pay $50,000 to Polyco - 11 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Jul 2026</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$862,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Aug 2026</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$782,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Sep 2026</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$702,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Oct 2026</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$622,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Nov 2026</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$542,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Dec 2026</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$462,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Jan 2027</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$382,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Feb 2027</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$302,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Mar 2027</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$222,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>Apr 2027</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$142,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-mar-plus">
                        <td><strong>May 2027</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$80,000</td>
                        <td class="negative">$62,713 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$11,670</td>
                        <td>Pay $80,000 to Polyco - 13 machines operational</td>
                    </tr>
                    <tr class="phase-payoff">
                        <td><strong>Jun 2027</strong></td>
                        <td class="machines">13 machines</td>
                        <td class="positive">+$472,500</td>
                        <td class="negative">-$380,830</td>
                        <td class="positive">+$91,670</td>
                        <td class="negative">-$62,713</td>
                        <td class="positive">$0 <span class="arrow-down">‚ñº</span></td>
                        <td class="positive">+$28,957</td>
                        <td>‚úÖ FULLY PAID OFF - Partnership Reset!</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="chart-container" style="margin: 40px 0; padding: 30px; background: #f8f9fa; border-radius: 10px; border-left: 5px solid #5a67d8;">
            <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 20px;">üìâ Exposure Paydown Progress</h3>
            <canvas id="exposureChart" style="max-height: 500px;"></canvas>
        </div>


    </div>

    <script>
        // Exposure paydown chart
        const ctx = document.getElementById('exposureChart').getContext('2d');
        
        const chartData = {
            labels: [
                'Oct 2025', 'Nov 2025', 'Dec 2025',
                'Jan 2026', 'Feb 2026', 'Mar 2026', 'Apr 2026', 'May 2026', 'Jun 2026',
                'Jul 2026', 'Aug 2026', 'Sep 2026', 'Oct 2026', 'Nov 2026', 'Dec 2026',
                'Jan 2027', 'Feb 2027', 'Mar 2027', 'Apr 2027', 'May 2027', 'Jun 2027'
            ],
            datasets: [{
                label: 'Exposure Balance',
                data: [
                    1170261, 1181487, 1192713, // Q4 2025 - slight increase
                    1167713, 1142713, // Jan-Feb 2026 - $25k/month payments
                    1092713, 1042713, 992713, 942713, // Mar-Jun 2026 - $50k/month payments
                    862713, 782713, 702713, 622713, 542713, 462713, // Jul-Dec 2026 - $80k/month
                    382713, 302713, 222713, 142713, 62713, 0 // Jan-Jun 2027 - final payoff
                ],
                borderColor: '#5a67d8',
                backgroundColor: 'rgba(90, 103, 216, 0.1)',
                borderWidth: 3,
                pointBackgroundColor: '#5a67d8',
                pointBorderColor: '#fff',
                pointBorderWidth: 2,
                pointRadius: 5,
                pointHoverRadius: 7,
                tension: 0.2,
                fill: true
            }]
        };

        // Calculate monthly paydown amounts
        const monthlyChange = [];
        for (let i = 0; i < chartData.datasets[0].data.length; i++) {
            if (i === 0) {
                monthlyChange.push(chartData.datasets[0].data[i] - 1158807); // Change from starting exposure
            } else {
                monthlyChange.push(chartData.datasets[0].data[i] - chartData.datasets[0].data[i-1]);
            }
        }

        const config = {
            type: 'bar',
            data: {
                labels: chartData.labels,
                datasets: [{
                    label: 'Exposure Balance',
                    data: chartData.datasets[0].data,
                    backgroundColor: function(context) {
                        const value = monthlyChange[context.dataIndex];
                        // Red for increases, green for decreases
                        if (value > 0) {
                            return 'rgba(220, 53, 69, 0.8)';
                        } else if (value < 0) {
                            return 'rgba(40, 167, 69, 0.8)';
                        } else {
                            return 'rgba(108, 117, 125, 0.8)';
                        }
                    },
                    borderColor: function(context) {
                        const value = monthlyChange[context.dataIndex];
                        if (value > 0) {
                            return '#dc3545';
                        } else if (value < 0) {
                            return '#28a745';
                        } else {
                            return '#6c757d';
                        }
                    },
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                aspectRatio: 2.5,
                plugins: {
                    title: {
                        display: false
                    },
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        padding: 12,
                        cornerRadius: 6,
                        titleFont: {
                            size: 14,
                            weight: 'bold'
                        },
                        bodyFont: {
                            size: 13
                        },
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed.y !== null) {
                                    label += new Intl.NumberFormat('en-US', {
                                        style: 'currency',
                                        currency: 'USD',
                                        minimumFractionDigits: 0,
                                        maximumFractionDigits: 0
                                    }).format(context.parsed.y);
                                }
                                return label;
                            },
                            afterLabel: function(context) {
                                const change = monthlyChange[context.dataIndex];
                                if (change !== 0) {
                                    const changeStr = new Intl.NumberFormat('en-US', {
                                        style: 'currency',
                                        currency: 'USD',
                                        minimumFractionDigits: 0,
                                        maximumFractionDigits: 0,
                                        signDisplay: 'always'
                                    }).format(change);
                                    return 'Monthly change: ' + changeStr;
                                }
                                return '';
                            }
                        }
                    },
                    datalabels: {
                        anchor: 'end',
                        align: 'top',
                        formatter: function(value, context) {
                            const change = monthlyChange[context.dataIndex];
                            if (change === 0) return '';
                            return new Intl.NumberFormat('en-US', {
                                style: 'currency',
                                currency: 'USD',
                                minimumFractionDigits: 0,
                                maximumFractionDigits: 0,
                                signDisplay: 'always'
                            }).format(change);
                        },
                        color: function(context) {
                            const value = monthlyChange[context.dataIndex];
                            return value > 0 ? '#dc3545' : '#28a745';
                        },
                        font: {
                            size: 10,
                            weight: 'bold'
                        },
                        offset: 8,
                        display: true
                    },
                    annotation: {
                        annotations: {
                            peak: {
                                type: 'label',
                                xValue: 2, // December 2025 (index 2)
                                yValue: 1192713,
                                backgroundColor: '#dc3545',
                                borderColor: '#dc3545',
                                borderRadius: 6,
                                borderWidth: 2,
                                color: 'white',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                },
                                padding: 6,
                                position: 'center',
                                xAdjust: 0,
                                yAdjust: -40,
                                content: 'PEAK EXPOSURE',
                                callout: {
                                    enabled: true,
                                    side: 20
                                }
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 1400000, // Increased to provide more space for labels
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)',
                            drawBorder: false
                        },
                        ticks: {
                            font: {
                                size: 11
                            },
                            color: '#6c757d',
                            padding: 8,
                            callback: function(value) {
                                return new Intl.NumberFormat('en-US', {
                                    style: 'currency',
                                    currency: 'USD',
                                    minimumFractionDigits: 0,
                                    maximumFractionDigits: 0,
                                    notation: 'compact',
                                    compactDisplay: 'short'
                                }).format(value);
                            }
                        }
                    },
                    x: {
                        grid: {
                            display: false,
                            drawBorder: false
                        },
                        ticks: {
                            font: {
                                size: 10
                            },
                            color: '#6c757d',
                            padding: 8,
                            autoSkip: false,
                            maxRotation: 45,
                            minRotation: 45
                        }
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'index'
                },
                animations: {
                    radius: {
                        duration: 400,
                        easing: 'linear',
                        loop: (context) => context.active
                    }
                }
            }
        };

        // Register the plugin
        Chart.register(ChartDataLabels);
        
        const exposureChart = new Chart(ctx, config);
    </script>
</body>
</html>
