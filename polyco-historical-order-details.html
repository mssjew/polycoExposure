<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polyco Historical Order Details</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            padding: 20px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
        }

        .header-section {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 3px solid #e9ecef;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 32px;
            font-weight: 600;
        }

        .subtitle {
            color: #6c757d;
            font-size: 18px;
            margin-bottom: 20px;
        }

        .summary-section {
            margin-bottom: 40px;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-left: 5px solid;
            text-align: center;
        }

        .card-blue {
            background: #e3f2fd;
            border-left-color: #2196f3;
        }

        .card-green {
            background: #e8f5e9;
            border-left-color: #4caf50;
        }

        .card-orange {
            background: #fff3e0;
            border-left-color: #ff9800;
        }

        .card-red {
            background: #ffebee;
            border-left-color: #f44336;
        }

        .card-purple {
            background: #f3e5f5;
            border-left-color: #9c27b0;
        }

        .card-teal {
            background: #e0f2f1;
            border-left-color: #009688;
        }

        .card-title {
            font-size: 13px;
            color: #6c757d;
            margin-bottom: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .card-value {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }

        .search-section {
            margin-bottom: 30px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
        }

        .search-input:focus {
            outline: none;
            border-color: #2196f3;
        }

        .filter-select {
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        .filter-select:focus {
            outline: none;
            border-color: #2196f3;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            background: white;
        }

        thead {
            background: #2c3e50;
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            white-space: nowrap;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            user-select: none;
        }

        th:hover {
            background: #34495e;
        }

        th.sortable::after {
            content: " ‚Üï";
            opacity: 0.5;
            font-size: 10px;
        }

        th.sorted-asc::after {
            content: " ‚Üë";
            opacity: 1;
        }

        th.sorted-desc::after {
            content: " ‚Üì";
            opacity: 1;
        }

        td {
            padding: 10px 8px;
            border-bottom: 1px solid #e9ecef;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        tbody tr:nth-child(even) {
            background: #fafbfc;
        }

        .status-delivered {
            color: #28a745;
            font-weight: 600;
        }

        .status-pending {
            color: #dc3545;
            font-weight: 600;
        }

        .status-onhold {
            color: #ffc107;
            font-weight: 600;
        }

        .amount-positive {
            color: #28a745;
            font-weight: 600;
        }

        .amount-negative {
            color: #dc3545;
            font-weight: 600;
        }

        .highlight {
            background: #fff9c4;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }

        .export-buttons {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .export-btn {
            padding: 8px 16px;
            border: 2px solid #2196f3;
            background: white;
            color: #2196f3;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
        }

        .export-btn:hover {
            background: #2196f3;
            color: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            .summary-cards {
                grid-template-columns: 1fr;
            }

            .search-section {
                flex-direction: column;
            }

            .table-container {
                font-size: 10px;
            }

            th, td {
                padding: 6px 4px;
            }
        }

        @media print {
            body {
                background: white;
            }
            .container {
                box-shadow: none;
                max-width: 100%;
            }
            .search-section, .export-buttons {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-section">
            <h1>üìä Polyco Historical Order Details</h1>
            <div class="subtitle">Comprehensive Order & Payment History</div>
            <div style="margin-top: 20px;">
                <a href="index.html" style="display: inline-block; padding: 10px 24px; background: #2c3e50; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; transition: background 0.3s ease; margin-right: 10px;">
                    ‚Üê Back to Exposure Dashboard
                </a>
                <a href="orders-shipped.html" style="display: inline-block; padding: 10px 24px; background: #28a745; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px; transition: background 0.3s ease;">
                    View Shipped Orders ‚Üí
                </a>
            </div>
        </div>

        <div class="summary-section">
            <div class="summary-cards">
                <div class="summary-card card-blue">
                    <div class="card-title">PO Amount</div>
                    <div class="card-value" id="totalPOAmount">$0</div>
                </div>
                <div class="summary-card card-purple">
                    <div class="card-title">Total Commitments</div>
                    <div class="card-value" id="totalCommitments">$0</div>
                </div>
                <div class="summary-card card-red">
                    <div class="card-title">Funds Received</div>
                    <div class="card-value" id="fundsReceived">$0</div>
                </div>
            </div>
        </div>

        <div class="export-buttons">
            <button class="export-btn" onclick="exportToCSV()">Export to CSV</button>
            <button class="export-btn" onclick="window.print()">Print</button>
        </div>

        <div class="search-section">
            <input type="text" class="search-input" id="searchInput" placeholder="Search by PO number, product, invoice...">
            <select class="filter-select" id="statusFilter">
                <option value="">All Status</option>
                <option value="delivered">Delivered</option>
                <option value="pending">Pending</option>
                <option value="onhold">On Hold</option>
            </select>
            <select class="filter-select" id="yearFilter">
                <option value="">All Years</option>
            </select>
        </div>

        <div class="table-container">
            <table id="orderTable">
                <thead>
                    <tr>
                        <th class="sortable" data-column="0">S.No.</th>
                        <th class="sortable" data-column="1">PO Number & Date</th>
                        <th class="sortable" data-column="2">Product Name</th>
                        <th class="sortable" data-column="3">PO Amount ($)</th>
                        <th class="sortable" data-column="4">Invoice Amount ($)</th>
                        <th class="sortable" data-column="5">Delivered Value ($)</th>
                        <th class="sortable" data-column="6">Funds Received ($)</th>
                        <th class="sortable" data-column="7">Delivery Date</th>
                    </tr>
                </thead>
                <tbody id="orderTableBody">
                    <!-- Table rows will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Raw data array - will be populated with the CSV data
        const rawOrderData = [
            {
                sno: "",
                poNumber: "cargo clearance + courier",
                productName: "",
                poAmount: "6,265.00",
                proformaInvoice: "",
                invoiceAmount: "6,265.00",
                deliveredValue: "6,265.00",
                fundsReceived: "6,265.00",
                fundsDate: "9/1/2023",
                containerStatus: "Clearance Charges + Courier",
                pendingValue: "0.00",
                deliveryDate: "1-Jan-2023",
                docStatus: ""
            },
            {
                sno: "1",
                poNumber: "PO.2259645-1 09/12/22",
                productName: "7x7 Tray",
                poAmount: "12,558.00",
                proformaInvoice: "PI.EFPI2212-0003 12/12/22",
                invoiceAmount: "12,558.00",
                deliveredValue: "11,866.40",
                fundsReceived: "12,558.00",
                fundsDate: "12/14/2022",
                containerStatus: "Yes",
                pendingValue: "-691.60",
                deliveryDate: "2-Feb-2023",
                docStatus: "Yes (1)"
            },
            {
                sno: "2",
                poNumber: "PO.2257858-2 09/12/22",
                productName: "S+M Medical",
                poAmount: "40,220.00",
                proformaInvoice: "PI.EFPI2212-0002 12/12/22",
                invoiceAmount: "40,220.00",
                deliveredValue: "40,220.00",
                fundsReceived: "40,220.00",
                fundsDate: "12/14/2022",
                containerStatus: "Yes",
                pendingValue: "0.00",
                deliveryDate: "22-Oct-2023",
                docStatus: "Yes (5)"
            },
            {
                sno: "3",
                poNumber: "OVERPAYMENT",
                productName: "",
                poAmount: "",
                proformaInvoice: "Funds Received Unknown = US$ 12,527.00",
                invoiceAmount: "-",
                deliveredValue: "",
                fundsReceived: "12,558.00",
                fundsDate: "1/15/2023",
                containerStatus: "N/A",
                pendingValue: "-12,558.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "4",
                poNumber: "PO 2257859-2 23/01/23",
                productName: "S+M Medical",
                poAmount: "40,220.00",
                proformaInvoice: "PI.EFPI2301-0002 24/01/23",
                invoiceAmount: "40,220.00",
                deliveredValue: "40,220.00",
                fundsReceived: "40,220.00",
                fundsDate: "2/2/2023",
                containerStatus: "Yes",
                pendingValue: "0.00",
                deliveryDate: "5-Mar-2024",
                docStatus: "Yes (11)"
            },
            {
                sno: "5",
                poNumber: "PO.2361044-1 21/03/23",
                productName: "Oasis Tray",
                poAmount: "34,650.00",
                proformaInvoice: "PI.EFPI20230321-004 21/03/23",
                invoiceAmount: "34,650.00",
                deliveredValue: "32,319.00",
                fundsReceived: "0.00",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "32,319.00",
                deliveryDate: "30-Dec-2024",
                docStatus: ""
            },
            {
                sno: "6",
                poNumber: "PO.2361043-1 21/03/23",
                productName: "Oasis Tray",
                poAmount: "38,493.00",
                proformaInvoice: "PI.EFPI20230321-003 21/03/23",
                invoiceAmount: "38,493.00",
                deliveredValue: "34,849.50",
                fundsReceived: "38,493.00",
                fundsDate: "3/29/2023",
                containerStatus: "Yes",
                pendingValue: "-3,643.50",
                deliveryDate: "28-Nov-2024",
                docStatus: ""
            },
            {
                sno: "7",
                poNumber: "PO 2257954-3 21/03/23",
                productName: "Oasis Tray",
                poAmount: "38,493.00",
                proformaInvoice: "PI.EFPI20230321-001 21/03/23",
                invoiceAmount: "38,493.00",
                deliveredValue: "40,939.50",
                fundsReceived: "38,493.00",
                fundsDate: "3/29/2023",
                containerStatus: "Yes",
                pendingValue: "2,446.50",
                deliveryDate: "22-Apr-2024",
                docStatus: "Yes (17)"
            },
            {
                sno: "8",
                poNumber: "PO.2257955-2 21/03/23",
                productName: "Oasis Tray",
                poAmount: "38,493.00",
                proformaInvoice: "PI.EFPI20230321-002 21/03/23",
                invoiceAmount: "38,493.00",
                deliveredValue: "38,850.00",
                fundsReceived: "38,493.00",
                fundsDate: "3/26/2023",
                containerStatus: "Yes",
                pendingValue: "357.00",
                deliveryDate: "29 Apri 2024",
                docStatus: "Yes (18)"
            },
            {
                sno: "9",
                poNumber: "OVERPAYMENT",
                productName: "",
                poAmount: "",
                proformaInvoice: "Over Payment ($40,220.00)",
                invoiceAmount: "-",
                deliveredValue: "",
                fundsReceived: "40,220.00",
                fundsDate: "4/21/2023",
                containerStatus: "N/A",
                pendingValue: "-40,220.00",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "10",
                poNumber: "PO.2362109-1 06/06/23",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "PI EFPI-20230607-001 07/06/23",
                invoiceAmount: "37,939.20",
                deliveredValue: "37,662.56",
                fundsReceived: "35,568.00",
                fundsDate: "11/06/2023 19/10/23",
                containerStatus: "Yes",
                pendingValue: "2,094.56",
                deliveryDate: "11-Sep-2023",
                docStatus: "Yes (4)"
            },
            {
                sno: "11",
                poNumber: "PO.2362110-2 07/09/23",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "PI EFPI-20230607-003 07/06/23",
                invoiceAmount: "37,939.20",
                deliveredValue: "37,583.52",
                fundsReceived: "35,568.00",
                fundsDate: "6/11/2023",
                containerStatus: "Yes",
                pendingValue: "2,015.52",
                deliveryDate: "31-Jan-2024",
                docStatus: "Yes (7)"
            },
            {
                sno: "12",
                poNumber: "PO.2362108-2 06/06/23",
                productName: "7x7 Tray",
                poAmount: "35,568.00",
                proformaInvoice: "PI EFPI-20230607-002 07/06/23",
                invoiceAmount: "35,568.00",
                deliveredValue: "36,259.60",
                fundsReceived: "35,568.00",
                fundsDate: "6/11/2023",
                containerStatus: "Yes",
                pendingValue: "691.60",
                deliveryDate: "27-Aug-2023",
                docStatus: "Yes (2)"
            },
            {
                sno: "13",
                poNumber: "PO.2362705-2 07/09/23",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "PI EFPI-20230717-004 17/07/23",
                invoiceAmount: "37,939.20",
                deliveredValue: "37,109.28",
                fundsReceived: "35,568.00",
                fundsDate: "7/23/2023",
                containerStatus: "Yes",
                pendingValue: "1,541.28",
                deliveryDate: "4-Nov-2023",
                docStatus: "Yes (6)"
            },
            {
                sno: "14",
                poNumber: "PO.2363263-2 23/08/23 (By Air)",
                productName: "7x7 Tray",
                poAmount: "19,760.00",
                proformaInvoice: "PI EFPI-20230823-001 23/08/23",
                invoiceAmount: "19,760.00",
                deliveredValue: "19,760.00",
                fundsReceived: "0.00",
                fundsDate: "",
                containerStatus: "Yes - AIR",
                pendingValue: "19,760.00",
                deliveryDate: "3-Sep-2023",
                docStatus: "Yes (3)"
            },
            {
                sno: "15",
                poNumber: "Cargo Clearance charges",
                productName: "",
                poAmount: "14,301.91",
                proformaInvoice: "EFCI-20230828-004 28/08/23",
                invoiceAmount: "14,301.91",
                deliveredValue: "14,301.91",
                fundsReceived: "0.00",
                fundsDate: "",
                containerStatus: "N/A",
                pendingValue: "14,301.91",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "16",
                poNumber: "PO.2362706-1 07/09/23",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "PI EFPI-20230909-001 09/09/23",
                invoiceAmount: "37,939.20",
                deliveredValue: "37,069.76",
                fundsReceived: "37,939.00",
                fundsDate: "10/19/2023",
                containerStatus: "Yes",
                pendingValue: "-869.24",
                deliveryDate: "31-Jan-2024",
                docStatus: "Yes (8)"
            },
            {
                sno: "17",
                poNumber: "PO.2362707-1 27/09/23",
                productName: "7x7 Tray",
                poAmount: "35,568.00",
                proformaInvoice: "PI EFPI-20231002-001 02/10/23",
                invoiceAmount: "35,568.00",
                deliveredValue: "36,753.60",
                fundsReceived: "37,939.00",
                fundsDate: "10/19/2023",
                containerStatus: "Yes",
                pendingValue: "-1,185.40",
                deliveryDate: "14-Apr-2024",
                docStatus: "Yes (15)"
            },
            {
                sno: "18",
                poNumber: "Oasis Tray Mould,Pet film,All plant tray molud clearnce",
                productName: "",
                poAmount: "24,008.31",
                proformaInvoice: "EFCI-20240219-004 19/02/24",
                invoiceAmount: "24,008.31",
                deliveredValue: "24,008.31",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "N/A",
                pendingValue: "24,008.31",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "19",
                poNumber: "Extra Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "Funds Rcvd US $60,000.00",
                invoiceAmount: "-",
                deliveredValue: "",
                fundsReceived: "60,000.00",
                fundsDate: "26/12/2023",
                containerStatus: "N/A",
                pendingValue: "-60,000.00",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "20",
                poNumber: "PO.2465417-1 19/01/24",
                productName: "S+M Medical",
                poAmount: "48,380.00",
                proformaInvoice: "EFPI-20240120-001 20/01/24",
                invoiceAmount: "48,380.00",
                deliveredValue: "48,380.00",
                fundsReceived: "0.00",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "48,380.00",
                deliveryDate: "7-Apr-2024",
                docStatus: "Yes (14)"
            },
            {
                sno: "21",
                poNumber: "PO.2465418-1 19/01/24",
                productName: "S+M Medical",
                poAmount: "48,380.00",
                proformaInvoice: "EFPI-20240120-002 20/01/24",
                invoiceAmount: "48,380.00",
                deliveredValue: "50,727.00",
                fundsReceived: "0.00",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "50,727.00",
                deliveryDate: "22-May-2024",
                docStatus: "Yes (16)"
            },
            {
                sno: "22",
                poNumber: "PO.2465639 - 30/01/24",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "EFPI-20240131-003 31/01/24",
                invoiceAmount: "37,939.20",
                deliveredValue: "35,923.68",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "35,923.68",
                deliveryDate: "28-10-2025",
                docStatus: ""
            },
            {
                sno: "23",
                poNumber: "PO.2465640 - 30/01/24",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "EFPI-20240131-004 31/01/24",
                invoiceAmount: "37,939.20",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "On Hold",
                docStatus: ""
            },
            {
                sno: "24",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "Funds Rcvd US $112,638.00 02/02/24",
                invoiceAmount: "-",
                deliveredValue: "",
                fundsReceived: "112,638.00",
                fundsDate: "02/02/2024",
                containerStatus: "N/A",
                pendingValue: "-112,638.00",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "25",
                poNumber: "PO.2465353 - 07/02/24",
                productName: "Allplant leaf bowl",
                poAmount: "38,016.00",
                proformaInvoice: "EFPI-20240212-002 12/02/24",
                invoiceAmount: "38,016.00",
                deliveredValue: "34,594.56",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "34,594.56",
                deliveryDate: "2-Apr-2024",
                docStatus: "Yes (13)"
            },
            {
                sno: "26",
                poNumber: "PO.2466124-1 26/02/24",
                productName: "7x7 Tray",
                poAmount: "8,892.00",
                proformaInvoice: "PI EFPI-20240227-004 27/2/24",
                invoiceAmount: "8,892.00",
                deliveredValue: "8,892.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes (Air Freight - DHL) 225 Boxes",
                pendingValue: "8,892.00",
                deliveryDate: "26-Feb-2024",
                docStatus: "Yes (9)"
            },
            {
                sno: "27",
                poNumber: "PO.2466141-1 26/02/24",
                productName: "7x7 Tray",
                poAmount: "29,640.00",
                proformaInvoice: "PI EFPI-20240227-005 27/2/24",
                invoiceAmount: "29,640.00",
                deliveredValue: "29,640.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes (Air Freight - DSV) 750 Boxes",
                pendingValue: "29,640.00",
                deliveryDate: "3-Mar-2024",
                docStatus: "Yes (10)"
            },
            {
                sno: "28",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "-",
                invoiceAmount: "0",
                deliveredValue: "0",
                fundsReceived: "150,000.00",
                fundsDate: "29/02/2024",
                containerStatus: "N/A",
                pendingValue: "-150,000.00",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "29",
                poNumber: "PO.2466446-1 26/02/24",
                productName: "7x7 Tray",
                poAmount: "11,381.76",
                proformaInvoice: "PI EFPI-20240320-001 20/03/24",
                invoiceAmount: "11,381.76",
                deliveredValue: "11,381.76",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes (Air Freight - DSV) 288 Boxes",
                pendingValue: "11,381.76",
                deliveryDate: "21-Mar-2024",
                docStatus: "Yes (12)"
            },
            {
                sno: "30",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "Funds Rcvd US$ 29,620 22//03/24 Funds Rcvd US$ 59,180 27/03/24",
                invoiceAmount: "-",
                deliveredValue: "0",
                fundsReceived: "88,840.96",
                fundsDate: "",
                containerStatus: "N/A",
                pendingValue: "-88,840.96",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "31",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "Funds Rcvd US $76,412 12/04/24",
                invoiceAmount: "-",
                deliveredValue: "0",
                fundsReceived: "76,432.00",
                fundsDate: "12/04/2024",
                containerStatus: "N/A",
                pendingValue: "-76,432.00",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "32",
                poNumber: "cargo Clearnce charges Pet film 15+90 rolls & Courier Charges",
                productName: "",
                poAmount: "8,437.43",
                proformaInvoice: "EFCI-20240522-014 22/05/24",
                invoiceAmount: "8,437.43",
                deliveredValue: "12,456.16",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "N/A",
                pendingValue: "12,456.16",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "33",
                poNumber: "PO.2466122-1 28/02/24",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "PI EFPI-20240229-006 29/02/24",
                invoiceAmount: "37,939.20",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "25,698.20",
                fundsDate: "",
                containerStatus: "N/A",
                pendingValue: "-25,698.20",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "38,016.00",
                fundsDate: "",
                containerStatus: "N/A",
                pendingValue: "-38,016.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "34",
                poNumber: "PO.2466123-1 28/02/24",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "PI EFPI-20240229-007 29/02/24",
                invoiceAmount: "37,939.20",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "35",
                poNumber: "PO.2466447-2 05/09/25",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "PI EFPI-20240320-003 20/03/24",
                invoiceAmount: "37,939.20",
                deliveredValue: "35,765.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "35,765.00",
                deliveryDate: "18-09-2025",
                docStatus: ""
            },
            {
                sno: "36",
                poNumber: "PO.2466448-2 05/09/25",
                productName: "7x7 Tray",
                poAmount: "37,939.20",
                proformaInvoice: "PI EFPI-20240320-002 20/03/24",
                invoiceAmount: "37,939.20",
                deliveredValue: "34,856.64",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "34,856.64",
                deliveryDate: "25-09-2025",
                docStatus: ""
            },
            {
                sno: "37",
                poNumber: "PO.2466524-1 22/03/24",
                productName: "Oasis Tray",
                poAmount: "39,196.50",
                proformaInvoice: "PI EFPI-20240320-004 20/03/24",
                invoiceAmount: "39,196.50",
                deliveredValue: "38,850.00",
                fundsReceived: "39,196.50",
                fundsDate: "13/06/24",
                containerStatus: "Yes",
                pendingValue: "-346.50",
                deliveryDate: "13-06-2024",
                docStatus: ""
            },
            {
                sno: "38",
                poNumber: "PO.2466525-1 22/03/24",
                productName: "Oasis Tray",
                poAmount: "39,196.50",
                proformaInvoice: "PI EFPI-20240320-005 20/03/24",
                invoiceAmount: "39,196.50",
                deliveredValue: "42,525.00",
                fundsReceived: "39,196.50",
                fundsDate: "13/06/24",
                containerStatus: "Yes",
                pendingValue: "3,328.50",
                deliveryDate: "06-08-2024",
                docStatus: ""
            },
            {
                sno: "39",
                poNumber: "PO.2466526-1 22/03/24",
                productName: "Oasis Tray",
                poAmount: "39,196.50",
                proformaInvoice: "PI EFPI-20240320-006 20/03/24",
                invoiceAmount: "39,196.50",
                deliveredValue: "43,050.00",
                fundsReceived: "39,196.50",
                fundsDate: "13/06/24",
                containerStatus: "Yes",
                pendingValue: "3,853.50",
                deliveryDate: "29-08-2024",
                docStatus: ""
            },
            {
                sno: "40",
                poNumber: "PO.2466527-1 22/03/24",
                productName: "Oasis Tray",
                poAmount: "39,196.50",
                proformaInvoice: "PI EFPI-20240320-007 20/03/24",
                invoiceAmount: "39,196.50",
                deliveredValue: "33,295.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "33,295.50",
                deliveryDate: "19-09-2024",
                docStatus: ""
            },
            {
                sno: "41",
                poNumber: "PO.2467665-1 29/05/24",
                productName: "Large Tray",
                poAmount: "38,016.00",
                proformaInvoice: "PI EFPI-20240529-001 29/5/24",
                invoiceAmount: "38,016.00",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "42",
                poNumber: "PO.2467489-2 11/06/24",
                productName: "S+M Tray Laminated & Unlaminated",
                poAmount: "47,845.00",
                proformaInvoice: "PI EFPI-20240529-002 29/5/24",
                invoiceAmount: "47,845.00",
                deliveredValue: "47,845.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "47,845.00",
                deliveryDate: "07-08-2024",
                docStatus: ""
            },
            {
                sno: "43",
                poNumber: "Cargo Clearnce Vat Payment Pet Film 150 rolls",
                productName: "Pet Film",
                poAmount: "10,598.00",
                proformaInvoice: "EFCI-202400611-015 11/06/24",
                invoiceAmount: "10,598.00",
                deliveredValue: "10,598.00",
                fundsReceived: "10,598.00",
                fundsDate: "13/06/25",
                containerStatus: "N/A",
                pendingValue: "0.00",
                deliveryDate: "11-06-2024",
                docStatus: ""
            },
            {
                sno: "44",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "-",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "150,000.00",
                fundsDate: "28/07/2024",
                containerStatus: "N/A",
                pendingValue: "-150,000.00",
                deliveryDate: "-",
                docStatus: ""
            },
            {
                sno: "45",
                poNumber: "Cargo Clearnce Vat Payment large medical Tray clamshell",
                productName: "Mold large medical tray",
                poAmount: "5,126.00",
                proformaInvoice: "EFCI-20240814-019 14/08/24",
                invoiceAmount: "5,126.00",
                deliveredValue: "5,126.00",
                fundsReceived: "5,162.00",
                fundsDate: "15/08/2024",
                containerStatus: "N/A",
                pendingValue: "0.00",
                deliveryDate: "14-08-2024",
                docStatus: ""
            },
            {
                sno: "46",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "50,000.00",
                fundsDate: "24/08/2024",
                containerStatus: "N/A",
                pendingValue: "-50,000.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "47",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "196,035.00",
                fundsDate: "17/09/2024",
                containerStatus: "N/A",
                pendingValue: "-196,035.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "48",
                poNumber: "PO.2467665-2 28/08/24",
                productName: "L+S+M Tray Laminated & Unlaminated",
                poAmount: "42,108.00",
                proformaInvoice: "PI EFPI-20240828-001 28/08/24",
                invoiceAmount: "42,108.00",
                deliveredValue: "42,472.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "42,472.00",
                deliveryDate: "12-11-2024",
                docStatus: ""
            },
            {
                sno: "49",
                poNumber: "PO.2468687-1 26/07/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20240726-001 26/07/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "33,148.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "33,148.50",
                deliveryDate: "9-10-2024",
                docStatus: ""
            },
            {
                sno: "50",
                poNumber: "PO.2468688-1 26/07/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20240726-002 26/07/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "33,180.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "33,180.00",
                deliveryDate: "7-11-2024",
                docStatus: ""
            },
            {
                sno: "51",
                poNumber: "PO.2468689-1 26/07/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20240726-003 26/07/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "33,600.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "33,600.00",
                deliveryDate: "13-11-2024",
                docStatus: ""
            },
            {
                sno: "52",
                poNumber: "PO.2468690-1 26/07/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20240726-004 26/07/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "34,650.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "34,650.00",
                deliveryDate: "18-11-2024",
                docStatus: ""
            },
            {
                sno: "53",
                poNumber: "PO.2468691-1 26/07/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20240726-005 26/07/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "33,001.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "33,001.50",
                deliveryDate: "29-12-2024",
                docStatus: ""
            },
            {
                sno: "54",
                poNumber: "PO.2469475-2 09/09/24",
                productName: "Oasis Plus Tray",
                poAmount: "33,447.60",
                proformaInvoice: "PI EFPI-20240909-001 09/09/24",
                invoiceAmount: "33,447.00",
                deliveredValue: "19,402.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "19,402.00",
                deliveryDate: "17-11-2024",
                docStatus: ""
            },
            {
                sno: "55",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "313,656.00",
                fundsDate: "20/10/2024",
                containerStatus: "N/A",
                pendingValue: "-313,656.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "56",
                poNumber: "PO.2469084-1 06/09/24",
                productName: "Meal Tray",
                poAmount: "36,720.00",
                proformaInvoice: "PI EFPI-20240909-002 09/09/24",
                invoiceAmount: "36,720.00",
                deliveredValue: "34,333.20",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "34,333.20",
                deliveryDate: "18-01-2025",
                docStatus: ""
            },
            {
                sno: "57",
                poNumber: "Cargo Clearnce charges OT 1430,Ot 1530 tray, Meal tray Dumpling Tray Molds",
                productName: "",
                poAmount: "20,163.00",
                proformaInvoice: "CI-EFCI20240930-022 30/09/24",
                invoiceAmount: "20,163.00",
                deliveredValue: "20,163.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "20,163.00",
                deliveryDate: "30-09-2024",
                docStatus: ""
            },
            {
                sno: "58",
                poNumber: "Sample Courier Charges",
                productName: "",
                poAmount: "7,983.00",
                proformaInvoice: "CI-EFCI20240930-023 30/09/24",
                invoiceAmount: "7,983.60",
                deliveredValue: "7,983.60",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "7,983.60",
                deliveryDate: "30-09-2024",
                docStatus: ""
            },
            {
                sno: "59",
                poNumber: "PO.2469737-2 03/10/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20241003-001 03/10/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "32,938.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "32,938.50",
                deliveryDate: "26-12-2024",
                docStatus: ""
            },
            {
                sno: "60",
                poNumber: "PO.2469738-1 03/10/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20241003-002 03/10/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "32,550.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "32,550.00",
                deliveryDate: "04-02-2025",
                docStatus: ""
            },
            {
                sno: "61",
                poNumber: "PO.2469739-1 03/10/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20241003-003 03/10/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "32,550.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "32,550.00",
                deliveryDate: "17-02-2025",
                docStatus: ""
            },
            {
                sno: "62",
                poNumber: "PO.2469740-1 03/10/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20241003-004 03/10/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "32,970.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "32,970.00",
                deliveryDate: "02-03-2025",
                docStatus: ""
            },
            {
                sno: "63",
                poNumber: "PO.2469741-1 03/10/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20241003-005 03/10/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "31,185.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "31,185.00",
                deliveryDate: "08-03-2025",
                docStatus: ""
            },
            {
                sno: "64",
                poNumber: "PO.2469742-1 03/10/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20241003-006 03/10/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "32,424.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "32,424.00",
                deliveryDate: "20-04-2025",
                docStatus: ""
            },
            {
                sno: "65",
                poNumber: "PO.2469743-1 03/10/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20241003-007 03/10/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "32,340.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "32,340.00",
                deliveryDate: "29-04-2025",
                docStatus: ""
            },
            {
                sno: "66",
                poNumber: "PO.2469744-1 03/10/24",
                productName: "Oasis Tray",
                poAmount: "39,207.00",
                proformaInvoice: "PI EFPI-20241003-008 03/10/24",
                invoiceAmount: "39,207.00",
                deliveredValue: "34,860.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "34,860.00",
                deliveryDate: "11-05-2025",
                docStatus: ""
            },
            {
                sno: "67",
                poNumber: "PO.2469083-2 18/10/24",
                productName: "Dumpling Tray",
                poAmount: "38,012.00",
                proformaInvoice: "PI EFPI-20241018-009 03/10/24",
                invoiceAmount: "38,012.00",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "68",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "47,845.00",
                fundsDate: "03/11/2024",
                containerStatus: "N/A",
                pendingValue: "-47,845.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "69",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "33,295.50",
                fundsDate: "05/12/2024",
                containerStatus: "N/A",
                pendingValue: "-33,295.50",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "70",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "242,384.50",
                fundsDate: "18/12/2024",
                containerStatus: "N/A",
                pendingValue: "-242,384.50",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "71",
                poNumber: "PO.2471119-1 09/12/2024",
                productName: "Oasis Tray & Oasis Plus Tray",
                poAmount: "24,544.80",
                proformaInvoice: "",
                invoiceAmount: "24,544.80",
                deliveredValue: "21,951.30",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "21,951.30",
                deliveryDate: "23-01-2025",
                docStatus: ""
            },
            {
                sno: "72",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "50,000.00",
                fundsDate: "22/01/2025",
                containerStatus: "N/A",
                pendingValue: "-50,000.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "73",
                poNumber: "Cargo Clearance charges PLA film 35 rolls,Pet film 54 rolls,X Ray Machine, Platinum 1,2,3 Molds",
                productName: "",
                poAmount: "35,475.04",
                proformaInvoice: "Ci-EFCI20250127-004 27/01/25",
                invoiceAmount: "35,475.04",
                deliveredValue: "35,475.04",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "N/A",
                pendingValue: "35,475.04",
                deliveryDate: "27-01-2025",
                docStatus: ""
            },
            {
                sno: "74",
                poNumber: "PO.2471139 11/12/24",
                productName: "Platinum Tray 1,2 & 3",
                poAmount: "36,951.00",
                proformaInvoice: "PI EFPI-20241211-003 11/12/24",
                invoiceAmount: "36,951.00",
                deliveredValue: "34,100.44",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "34,100.44",
                deliveryDate: "21-06-2025",
                docStatus: ""
            },
            {
                sno: "75",
                poNumber: "PO.2572204-1 03/03/25",
                productName: "Oasis Plus Tray",
                poAmount: "19,380.00",
                proformaInvoice: "PI EFPI-20250304-001 04/03/25",
                invoiceAmount: "19,380.00",
                deliveredValue: "19,870.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "19,870.00",
                deliveryDate: "22-07-2025",
                docStatus: ""
            },
            {
                sno: "76",
                poNumber: "PO.2572313-1 03/03/25",
                productName: "Small, Medium, Large Medical Clamshells",
                poAmount: "50,270.00",
                proformaInvoice: "PI EFPI-20250304-002 04/03/25",
                invoiceAmount: "50,270.00",
                deliveredValue: "47,173.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "47,173.00",
                deliveryDate: "17-06-2025",
                docStatus: ""
            },
            {
                sno: "77",
                poNumber: "PO.2572314-1 03/03/25",
                productName: "Small and Medium Medical Clamshells",
                poAmount: "46,200.00",
                proformaInvoice: "PI EFPI-20250304-003 04/03/25",
                invoiceAmount: "46,200.00",
                deliveredValue: "46,181.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "46,181.00",
                deliveryDate: "10-05-2025",
                docStatus: ""
            },
            {
                sno: "78",
                poNumber: "PO.2572315-1 03/03/25",
                productName: "Small, Medium, Large Medical Clamshells",
                poAmount: "50,270.00",
                proformaInvoice: "PI EFPI-20250304-004 04/03/25",
                invoiceAmount: "50,270.00",
                deliveredValue: "47,996.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "47,996.00",
                deliveryDate: "14-08-2025",
                docStatus: ""
            },
            {
                sno: "79",
                poNumber: "PO.2572991-2 10/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250410-001 04/03/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "40,057.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "40,057.50",
                deliveryDate: "27-05-2025",
                docStatus: ""
            },
            {
                sno: "80",
                poNumber: "PO.2572992-2 10/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250410-002 04/03/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "42,000.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "42,000.00",
                deliveryDate: "01-07-2025",
                docStatus: ""
            },
            {
                sno: "81",
                poNumber: "PO.2572993-2 10/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250410-003 04/03/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "42,052.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "42,052.50",
                deliveryDate: "12-08-2025",
                docStatus: ""
            },
            {
                sno: "82",
                poNumber: "PO.2572994-2 10/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250410-004 04/03/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "41,296.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "41,296.50",
                deliveryDate: "13-08-2025",
                docStatus: ""
            },
            {
                sno: "83",
                poNumber: "PO.2572995-2 10/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250410-005 04/03/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "41,160.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "41,160.00",
                deliveryDate: "10-09-2025",
                docStatus: ""
            },
            {
                sno: "84",
                poNumber: "PO.2572996-2 10/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250410-006 04/03/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "41,443.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "41,443.50",
                deliveryDate: "21-09-2025",
                docStatus: ""
            },
            {
                sno: "85",
                poNumber: "PO.2573202-1 12304/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250423-007 23/04/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "40,782.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "40,782.00",
                deliveryDate: "21-10-2025",
                docStatus: ""
            },
            {
                sno: "86",
                poNumber: "PO.2573203-1 23/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250423-008 23/04/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "34,009.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "34,009.50",
                deliveryDate: "22-09-2025",
                docStatus: ""
            },
            {
                sno: "87",
                poNumber: "PO.2573204-1 23/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250423-009 23/04/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "42,000.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "42,000.00",
                deliveryDate: "20-11-2025",
                docStatus: ""
            },
            {
                sno: "88",
                poNumber: "PO.2573205-1 23/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250423-010 23/04/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "42,000.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "42,000.00",
                deliveryDate: "22-11-2025",
                docStatus: ""
            },
            {
                sno: "89",
                poNumber: "PO.2573206-1 23/04/25",
                productName: "Oasis Tray",
                poAmount: "32,896.50",
                proformaInvoice: "PI EFPI-20250423-011 23/04/25",
                invoiceAmount: "32,896.50",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "90",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "125,000.00",
                fundsDate: "06/04/25",
                containerStatus: "N/A",
                pendingValue: "-125,000.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "91",
                poNumber: "Product Insurance Renewal Exp.",
                productName: "",
                poAmount: "10,500.00",
                proformaInvoice: "",
                invoiceAmount: "10,500.00",
                deliveredValue: "10,500.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "N/A",
                pendingValue: "10,500.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "",
                poNumber: "PO.2573352-1 08/05/25",
                productName: "Platinum Tray 1",
                poAmount: "34,816.00",
                proformaInvoice: "PI EFPI-20250508-001 08/05/25",
                invoiceAmount: "34,816.00",
                deliveredValue: "34,990.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "34,990.00",
                deliveryDate: "13-10-2025",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "PO.2573353-1 08/05/25",
                productName: "Platinum Tray 1",
                poAmount: "34,816.00",
                proformaInvoice: "PI EFPI-20250508-002 08/05/25",
                invoiceAmount: "34,816.00",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "PO.2573354-1 08/05/25",
                productName: "Platinum Tray 1,2 & 3",
                poAmount: "43,756.00",
                proformaInvoice: "PI EFPI-20250508-001 08/05/25",
                invoiceAmount: "43,756.00",
                deliveredValue: "37,355.18",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "37,355.18",
                deliveryDate: "27-08-2025",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "10,500.00",
                fundsDate: "23/04/25",
                containerStatus: "N/A",
                pendingValue: "-10,500.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "260,606.00",
                fundsDate: "11/05/25",
                containerStatus: "N/A",
                pendingValue: "-260,606.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "227,000.00",
                fundsDate: "01/06/25",
                containerStatus: "N/A",
                pendingValue: "-227,000.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Cargo Clearnce PLA Film,Skin fresh Film,Evertable mold,Cpet Film",
                productName: "",
                poAmount: "20,164.35",
                proformaInvoice: "",
                invoiceAmount: "20,164.35",
                deliveredValue: "20,164.35",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "20,164.35",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "3,944.75",
                fundsDate: "09/07/25",
                containerStatus: "Yes",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "199,298.50",
                fundsDate: "10/07/25",
                containerStatus: "N/A",
                pendingValue: "-199,298.50",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "98,190.00",
                fundsDate: "03/08/25",
                containerStatus: "N/A",
                pendingValue: "-98,190.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "104,466.00",
                fundsDate: "27/08/25",
                containerStatus: "N/A",
                pendingValue: "-104,466.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "173,733.12",
                fundsDate: "11/09/25",
                containerStatus: "",
                pendingValue: "-173,733.12",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "PO 2574888-2 08/05/25",
                productName: "2\" Everytable Tray",
                poAmount: "25,872.00",
                proformaInvoice: "PI EFPI-20250908-001 08/09/25",
                invoiceAmount: "25,872.00",
                deliveredValue: "29,360.00",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "29,360.80",
                deliveryDate: "29-09-2025",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "20,164.35",
                fundsDate: "",
                containerStatus: "N/A",
                pendingValue: "-20,164.35",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "PO-2574889-1",
                productName: "2\" Everytable Tray / point five tray Lid",
                poAmount: "31,489.92",
                proformaInvoice: "PI EFPI-20250926-002 26/09/25",
                invoiceAmount: "31,489.92",
                deliveredValue: "31,178.88",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "31,178.88",
                deliveryDate: "29-10-2025",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "PO-2574890-1",
                productName: "2\" Everytable Tray / point five tray Lid",
                poAmount: "31,507.20",
                proformaInvoice: "PI EFPI-20250926-003 26/09/25",
                invoiceAmount: "31,507.20",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "PO-2574891-1",
                productName: "2\" Everytable Tray / point five tray Lid",
                poAmount: "31,507.20",
                proformaInvoice: "PI EFPI-20250926-004 26/09/25",
                invoiceAmount: "31,507.20",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "PO-2574892-1",
                productName: "2\" Everytable Tray Pet Laminated",
                poAmount: "31,651.20",
                proformaInvoice: "PI EFPI-20250926-005 26/09/25",
                invoiceAmount: "31,651.20",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "PO-2574893-1",
                productName: "2\" Everytable Tray Pet Laminated",
                poAmount: "31,651.20",
                proformaInvoice: "PI EFPI-20250926-006 26/09/25",
                invoiceAmount: "31,651.20",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "#REF!",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "220,000.00",
                fundsDate: "07/10/2025",
                containerStatus: "N/A",
                pendingValue: "-220,000.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "116",
                poNumber: "Funds Rcvd",
                productName: "",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "",
                fundsReceived: "218,982.50",
                fundsDate: "06/11/2025",
                containerStatus: "N/A",
                pendingValue: "218,982.50",
                deliveryDate: "06-11-2025",
                docStatus: ""
            },
            {
                sno: "118",
                poNumber: "Cargo Clearance Plastic Roll,Oyster Tray Mold,No.3 tray lamination Mold",
                productName: "",
                poAmount: "",
                proformaInvoice: "EFCI20251110-034 10112025",
                invoiceAmount: "",
                deliveredValue: "15,496.30",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "15,496.30",
                deliveryDate: "10-11-2025",
                docStatus: ""
            },
            {
                sno: "119",
                poNumber: "Cargo Clearance Plastic Film 56 Rolls",
                productName: "",
                poAmount: "",
                proformaInvoice: "EFCI20251118-035 18112025",
                invoiceAmount: "",
                deliveredValue: "8,207.70",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "8,207.70",
                deliveryDate: "18-11-2025",
                docStatus: ""
            },
            {
                sno: "120",
                poNumber: "PO.2575936-1 15/02/26",
                productName: "Oasis Tray",
                poAmount: "42,000.00",
                proformaInvoice: "PI EFPI-20251103-001 03/11/25",
                invoiceAmount: "42,000.00",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "121",
                poNumber: "PO.2575937-1 10/03/26",
                productName: "Oasis Tray",
                poAmount: "42,000.00",
                proformaInvoice: "PI EFPI-20251103-002 03/11/25",
                invoiceAmount: "42,000.00",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "122",
                poNumber: "PO.2575938-1 25/03/26",
                productName: "Oasis Tray",
                poAmount: "42,000.00",
                proformaInvoice: "PI EFPI-20251103-003 03/11/25",
                invoiceAmount: "42,000.00",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "123",
                poNumber: "PO 2576084-1 20/03/26",
                productName: "Platinum Packaging Tray 1 Comp PLA Lining",
                poAmount: "34,816.00",
                proformaInvoice: "PI EFPI-20251103-004 03/11/25",
                invoiceAmount: "34,816.00",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "124",
                poNumber: "PO 2576085-1 15/02/26",
                productName: "Platinum Packaging Tray 1 Comp PLA Lining - Platinium Packaging Tray 3 Cap. PLA Lining",
                poAmount: "38,579.80",
                proformaInvoice: "PI EFPI-20251103-005 03/11/25",
                invoiceAmount: "38,579.80",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "125",
                poNumber: "PO 2576194-1 18/11/25",
                productName: "Point Five Fibre Tray 2'' PET Laminated",
                poAmount: "6,451.20",
                proformaInvoice: "PI EFPI-20251111-006 11/11/25",
                invoiceAmount: "6,451.20",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "6,451.20",
                deliveryDate: "23-11-2025",
                docStatus: ""
            },
            {
                sno: "126",
                poNumber: "PO 2575300-1 07/11/25",
                productName: "Madison Oysis Tray",
                poAmount: "15,232.00",
                proformaInvoice: "PI EFPI-20251008-007 08/10/25",
                invoiceAmount: "15,232.00",
                deliveredValue: "",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "No",
                pendingValue: "0.00",
                deliveryDate: "",
                docStatus: ""
            },
            {
                sno: "129",
                poNumber: "",
                productName: "Potato tray 7x7",
                poAmount: "",
                proformaInvoice: "",
                invoiceAmount: "",
                deliveredValue: "4,742.40",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "4,742.40",
                deliveryDate: "23-11-2025",
                docStatus: ""
            },
            {
                sno: "130",
                poNumber: "Freight charges potato tray & point five tray",
                productName: "",
                poAmount: "",
                proformaInvoice: "EFCI20251123-039 23112025",
                invoiceAmount: "",
                deliveredValue: "17,531.50",
                fundsReceived: "",
                fundsDate: "",
                containerStatus: "Yes",
                pendingValue: "15,496.30",
                deliveryDate: "23-11-2025",
                docStatus: ""
            }
        ];

        let filteredData = [...rawOrderData];
        let sortColumn = -1;
        let sortDirection = 'asc';

        // Function to parse currency values
        function parseCurrency(value) {
            if (!value || value === '-' || value === '') return 0;
            return parseFloat(value.toString().replace(/[$,]/g, '')) || 0;
        }

        // Function to format currency
        function formatCurrency(value) {
            const num = parseCurrency(value);
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(Math.abs(num));
        }

        // Function to parse and standardize dates
        function parseDate(dateStr) {
            if (!dateStr || dateStr === '' || dateStr === '-' || dateStr.toLowerCase() === 'on hold') {
                return null;
            }
            
            // Handle different date formats in the data
            let parsedDate = null;
            
            // Format: "2-Feb-2023" or "22-Oct-2023"
            if (dateStr.includes('-') && dateStr.length <= 11) {
                const parts = dateStr.split('-');
                if (parts.length === 3) {
                    const day = parts[0];
                    const month = parts[1];
                    const year = parts[2];
                    
                    // Convert month name to number
                    const monthMap = {
                        'Jan': '01', 'Feb': '02', 'Mar': '03', 'Apr': '04',
                        'May': '05', 'Jun': '06', 'Jul': '07', 'Aug': '08',
                        'Sep': '09', 'Oct': '10', 'Nov': '11', 'Dec': '12'
                    };
                    
                    if (monthMap[month]) {
                        parsedDate = new Date(year, parseInt(monthMap[month]) - 1, parseInt(day));
                    }
                }
            }
            
            // Format: "28-10-2025" or "18-09-2025"
            else if (dateStr.match(/^\d{1,2}-\d{1,2}-\d{4}$/)) {
                const parts = dateStr.split('-');
                const day = parseInt(parts[0]);
                const month = parseInt(parts[1]) - 1; // Month is 0-indexed
                const year = parseInt(parts[2]);
                parsedDate = new Date(year, month, day);
            }
            
            // Format: "06-11-2025"
            else if (dateStr.match(/^\d{2}-\d{2}-\d{4}$/)) {
                const parts = dateStr.split('-');
                const day = parseInt(parts[0]);
                const month = parseInt(parts[1]) - 1;
                const year = parseInt(parts[2]);
                parsedDate = new Date(year, month, day);
            }
            
            // If parsing failed, try native Date parsing
            if (!parsedDate || isNaN(parsedDate.getTime())) {
                parsedDate = new Date(dateStr);
            }
            
            // Return null if still invalid
            return (!parsedDate || isNaN(parsedDate.getTime())) ? null : parsedDate;
        }

        // Function to format date consistently
        function formatDate(dateStr) {
            const date = parseDate(dateStr);
            if (!date) {
                return dateStr || ''; // Return original if can't parse
            }
            
            // Format as DD-MMM-YYYY (e.g., "02-Feb-2023")
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                           'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            
            const day = date.getDate().toString().padStart(2, '0');
            const month = months[date.getMonth()];
            const year = date.getFullYear();
            
            return `${day}-${month}-${year}`;
        }

        // Calculate summary statistics
        function calculateSummary() {
            let totalPOAmount = 0;
            let totalDelivered = 0;
            let fundsReceived = 0;
            let cargoCharges = 0;

            rawOrderData.forEach(row => {
                // Separate PO amounts from cargo charges
                if (row.poNumber && (row.poNumber.toLowerCase().includes('cargo') || 
                    row.poNumber.toLowerCase().includes('clearance') || 
                    row.poNumber.toLowerCase().includes('courier') ||
                    row.poNumber.toLowerCase().includes('freight') ||
                    row.poNumber.toLowerCase().includes('insurance'))) {
                    cargoCharges += parseCurrency(row.poAmount);
                } else {
                    totalPOAmount += parseCurrency(row.poAmount);
                }
                
                totalDelivered += parseCurrency(row.deliveredValue);
                
                // Calculate funds received
                if (row.fundsReceived) {
                    fundsReceived += parseCurrency(row.fundsReceived);
                }
            });

            // Calculate total commitments (PO Amount + Cargo Charges)
            const totalCommitments = totalPOAmount + cargoCharges;

            // Update summary cards
            document.getElementById('totalPOAmount').textContent = formatCurrency(totalPOAmount);
            document.getElementById('totalCommitments').textContent = formatCurrency(totalCommitments);
            document.getElementById('fundsReceived').textContent = formatCurrency(fundsReceived);
        }

        // Populate year filter
        function populateYearFilter() {
            const years = new Set();
            rawOrderData.forEach(row => {
                if (row.deliveryDate) {
                    const year = row.deliveryDate.split('-')[2];
                    if (year && year.length === 4) {
                        years.add(year);
                    }
                }
            });
            
            const yearFilter = document.getElementById('yearFilter');
            Array.from(years).sort().reverse().forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearFilter.appendChild(option);
            });
        }

        // Get status from row data
        function getStatus(row) {
            if (row.deliveryDate && row.deliveryDate.toLowerCase() === 'on hold') {
                return 'onhold';
            } else if (row.containerStatus && row.containerStatus.toLowerCase() === 'yes') {
                return 'delivered';
            } else if (parseCurrency(row.pendingValue) > 0) {
                return 'pending';
            }
            return '';
        }

        // Render table
        function renderTable() {
            const tbody = document.getElementById('orderTableBody');
            tbody.innerHTML = '';

            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="no-data">No matching records found</td></tr>';
                return;
            }

            filteredData.forEach((row, index) => {
                const tr = document.createElement('tr');
                
                tr.innerHTML = `
                    <td>${row.sno || ''}</td>
                    <td>${row.poNumber || ''}</td>
                    <td>${row.productName || ''}</td>
                    <td>${row.poAmount ? formatCurrency(row.poAmount) : ''}</td>
                    <td>${row.invoiceAmount && row.invoiceAmount !== '-' ? formatCurrency(row.invoiceAmount) : ''}</td>
                    <td>${row.deliveredValue ? formatCurrency(row.deliveredValue) : ''}</td>
                    <td>${row.fundsReceived ? formatCurrency(row.fundsReceived) : ''}</td>
                    <td>${formatDate(row.deliveryDate)}</td>
                `;
                
                tbody.appendChild(tr);
            });
        }

        // Filter data
        function filterData() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const yearFilter = document.getElementById('yearFilter').value;

            filteredData = rawOrderData.filter(row => {
                // Search filter
                const matchesSearch = !searchTerm || 
                    Object.values(row).some(value => 
                        value && value.toString().toLowerCase().includes(searchTerm)
                    );

                // Status filter
                const status = getStatus(row);
                const matchesStatus = !statusFilter || status === statusFilter;

                // Year filter
                let matchesYear = !yearFilter;
                if (yearFilter && row.deliveryDate) {
                    const year = row.deliveryDate.split('-')[2];
                    matchesYear = year === yearFilter;
                }

                return matchesSearch && matchesStatus && matchesYear;
            });

            renderTable();
        }

        // Sort table
        function sortTable(column) {
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }

            // Update header classes
            document.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
            });
            const currentTh = document.querySelector(`th[data-column="${column}"]`);
            currentTh.classList.add(sortDirection === 'asc' ? 'sorted-asc' : 'sorted-desc');

            // Sort data
            const keys = ['sno', 'poNumber', 'productName', 'poAmount', 
                         'invoiceAmount', 'deliveredValue', 'fundsReceived', 'deliveryDate'];
            const key = keys[column];

            filteredData.sort((a, b) => {
                let aVal = a[key] || '';
                let bVal = b[key] || '';

                // Handle currency columns
                if (['poAmount', 'invoiceAmount', 'deliveredValue', 'fundsReceived'].includes(key)) {
                    aVal = parseCurrency(aVal);
                    bVal = parseCurrency(bVal);
                }
                // Handle date column
                else if (key === 'deliveryDate') {
                    const aDate = parseDate(aVal);
                    const bDate = parseDate(bVal);
                    
                    // Handle null dates (put them at the end)
                    if (!aDate && !bDate) return 0;
                    if (!aDate) return sortDirection === 'asc' ? 1 : -1;
                    if (!bDate) return sortDirection === 'asc' ? -1 : 1;
                    
                    aVal = aDate.getTime();
                    bVal = bDate.getTime();
                }

                if (aVal < bVal) return sortDirection === 'asc' ? -1 : 1;
                if (aVal > bVal) return sortDirection === 'asc' ? 1 : -1;
                return 0;
            });

            renderTable();
        }

        // Export to CSV
        function exportToCSV() {
            const headers = ['S.No.', 'PO Number', 'Product Name', 'PO Amount', 
                           'Invoice Amount', 'Delivered Value', 'Funds Received', 'Delivery Date'];
            
            let csv = headers.join(',') + '\n';
            
            filteredData.forEach(row => {
                const values = [
                    row.sno,
                    `"${row.poNumber}"`,
                    `"${row.productName}"`,
                    row.poAmount,
                    row.invoiceAmount,
                    row.deliveredValue,
                    row.fundsReceived,
                    row.deliveryDate
                ];
                csv += values.join(',') + '\n';
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'polyco-order-details.csv';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', filterData);
        document.getElementById('statusFilter').addEventListener('change', filterData);
        document.getElementById('yearFilter').addEventListener('change', filterData);

        document.querySelectorAll('th.sortable').forEach(th => {
            th.addEventListener('click', () => {
                sortTable(parseInt(th.dataset.column));
            });
        });

        // Initialize
        calculateSummary();
        populateYearFilter();
        renderTable();
    </script>
</body>
</html>